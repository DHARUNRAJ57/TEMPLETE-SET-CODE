<span>
    <section class="booking-form-section">
        <div>
            <div class="section-layout-3-main">
                <div class="section-1">
                    <div class="container">
                        <div class="box-shadow-1" style="max-width: 100%">
                            <h3 class="text-center">Book Your Taxi</h3>
                            <p class="text-gray-900 text-center">
                                <span style="max-width: 400px" class="wow clipInLeft" data-wow-delay=".2s">
                                    Your journey begins with a simple booking. Let's make
                                    memories!
                                </span>
                            </p>
                            <br />
                            <div>
                                <form action="/verification" method="post" id="bookingForm" class="container"
                                    onsubmit="return formValidation(event)">
                                    <div class="d-flex flex-md-row flex-column gap-2">
                                        <button class="col theme-btn" type="button" id="outstation" onclick="toggleTrip(`0`)">
                                            Outstation<i class="fas fa-arrow-right"></i>
                                        </button>
                                        <button class="col theme-btn" type="button" id="airport" onclick="toggleTrip(`1`)">
                                            Airport<i class="fas fa-arrow-right"></i>
                                        </button>
                                        <button class="col theme-btn" type="button" id="rental" onclick="toggleTrip(`2`)">
                                            Rental<i class="fas fa-arrow-right"></i>
                                        </button>
                                    </div>
                                    <br />
                                    <div class="row row-cols-12">
                                        <div class="col-12 select-trip d-none" style="padding-bottom: 18px;">
                                            <div class="input1_wrapper">
                                                <select name="service" id="service" class="select form-control selectBtn"
                                                    style="width: 100%">
                                                    <option value="" selected disabled>Choose Trip Type</option>
                                                    <option value="0">Outstation</option>
                                                    <option value="1">Airport</option>
                                                    <option value="2">Rental</option>

                                                </select>
                                                <input name="serviceType" type="text" class="form-control input" placeholder="Name" />
                                            </div>
                                        </div>
                                        <div class="col-12 select-trip" style="padding-bottom: 18px;" id="outstationService">
                                            <div class="input1_wrapper">
                                                <select name="outstationService" class="select form-control selectBtn"
                                                    style="width: 100%">
                                                    <option value="" selected disabled>Choose Service Type</option>
                                                    <option value="0">One way Trip</option>
                                                    <option value="1">Round Trip</option>

                                                </select>

                                            </div>
                                        </div>
                                        <div class="col-12 select-trip" style="padding-bottom: 18px;"  id="airportService">
                                            <div class="input1_wrapper">
                                                <select name="airportService" class="select form-control selectBtn"
                                                    style="width: 100%">
                                                    <option value="" selected disabled>Choose Service Type</option>
                                                    <option value="0">PickUp from Airport</option>
                                                    <option value="1">Drop to Airport</option>
                                                </select>

                                            </div>
                                        </div>
                                        <div class="col-6 d-flex flex-column justify-content-end align-items-end gap-4">

                                            <div class="btn-trip">
                                                <button class="theme-btn" type="button" id="one-way-trip" onclick="toggleService(`0`)">
                                                    One Way Trip<i class="fas fa-arrow-right"></i>
                                                </button>
                                                <button class="theme-btn" type="button" id="pickUp" onclick="toggleService(`0`)">
                                                    PickUp from Airport<i class="fas fa-arrow-right"></i>
                                                </button>
                                            </div>

                                            <div class="input1_wrapper w-100">
                                                <div class="input1">
                                                    Name:
                                                    <input name="name" type="text" class="form-control input"
                                                        placeholder="Name" required />
                                                </div>
                                            </div>

                                            <div class="input1_wrapper w-100">
                                                <div class="input1">
                                                    Pickup Location:
                                                    <input name="pickupLocation" id="pick" type="text"
                                                        class="form-control input" placeholder="Pickup Location*"
                                                        required />
                                                </div>
                                            </div>

                                        </div>
                                        <div class="col-6 d-flex flex-column justify-content-start align-items-start ps-0 ps-sm-2 gap-4">

                                            <div class="btn-trip">
                                                <button class="theme-btn" type="button" id="round-trip" onclick="toggleService(`1`)">
                                                    Round Trip<i class="fas fa-arrow-right"></i>
                                                </button>
                                                <button class="theme-btn" type="button" id="dropDown" onclick="toggleService(`1`)">
                                                    Drop to Airport<i class="fas fa-arrow-right"></i>
                                                </button>
                                            </div>

                                            <div class="input1_wrapper w-100">
                                                <div class="input1">
                                                    Phone Number:
                                                    <input name="mobile" id="mobile" type="number"
                                                        class="form-control input" placeholder="Phone Number" required />
                                                </div>
                                            </div>

                                            <div class="input1_wrapper w-100" id="dropParent">
                                                <div class="input1">
                                                    Drop Off Location:
                                                    <input name="dropLocation" id="drop" type="text"
                                                        class="form-control input" placeholder="Drop Off Location" />
                                                </div>
                                            </div>

                                            
                                            <div class="input1_wrapper w-100" id="rentalParent" >
                                                <div class="input1">
                                                    Rental Package Type:
                                                    <select name="rentalpackage" class="select form-control selectBtn" style="width: 100%">
                                                        <option value="" selected disabled>Choose Rental Package</option>
                                                        <%
                                                            data?.RentalPackages?.forEach((package)=>{
                                                        %>
                                                                <option value="<%= package.trip %>"><%= package.pack %></option>
                                                        <%
                                                            })
                                                        %>
                                                    </select>       
                                                </div>                                     
                                            </div>

                                        </div>

                                        <p class="form-messages error text-center mb-3" id="form-messages"></p>
                                        <div class="col-12 more-btn pt-20 text-center" data-aos="fade-up"
                                            data-aos-duration="1500" data-aos-offset="50">
                                            <button class="theme-btn" type="submit" id="book">
                                                Book Your Taxi<i class="fas fa-arrow-right"></i>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>

        const outstation = document.getElementById('outstation');
        const airport = document.getElementById('airport');
        const rental = document.getElementById('rental');

        const oneWayTrip = document.getElementById('one-way-trip');
        const roundTrip = document.getElementById('round-trip');

        const pickUp = document.getElementById('pickUp');
        const dropDown = document.getElementById('dropDown');

        const airportService = document.getElementById('airportService');
        const outstationService = document.getElementById('outstationService');
        
        const rentalParent = document.getElementById('rentalParent');
        const dropParent = document.getElementById('dropParent');

        function toggleService(value){
            const tripType = document.querySelector("#bookingForm [name='service']").value;
            const service = value;
            
            if (tripType == '0') {
                if (service == '1') {
                    oneWayTrip.classList.remove('active')
                    roundTrip.classList.add('active')
                } else {
                    oneWayTrip.classList.add('active')
                    roundTrip.classList.remove('active')
                }
                document.querySelector("#bookingForm [name='outstationService']").value = value
            } else if (tripType == '1') {
                if (service == '1') {
                    pickUp.classList.remove('active')
                    dropDown.classList.add('active')
                } else {
                    pickUp.classList.add('active')
                    dropDown.classList.remove('active')
                }
                document.querySelector("#bookingForm [name='airportService']").value = value
            }
        }

        function toggleTrip(value) {
            const tripType = value;


            if(tripType == '0'){

                outstation.classList.add('active')
                airport.classList.remove('active')
                rental.classList.remove('active')
                
                airportService.classList.add('hidden')
                outstationService.classList.remove('hidden')
                
                oneWayTrip.classList.remove('hidden')
                roundTrip.classList.remove('hidden')
                
                pickUp.classList.add('hidden')
                dropDown.classList.add('hidden') 
                
                rentalParent.classList.add('hidden')               
                dropParent.classList.remove('hidden')               
                
            }else if(tripType == '1'){
                
                outstation.classList.remove('active')
                airport.classList.add('active')
                rental.classList.remove('active')
                
                airportService.classList.remove('hidden')
                outstationService.classList.add('hidden')
                
                oneWayTrip.classList.add('hidden')
                roundTrip.classList.add('hidden')
                
                pickUp.classList.remove('hidden')
                dropDown.classList.remove('hidden')      
                
                rentalParent.classList.add('hidden')                 
                dropParent.classList.remove('hidden')    
                
            }else if( tripType == '2'){
                
                outstation.classList.remove('active')
                airport.classList.remove('active')
                rental.classList.add('active')
                
                oneWayTrip.classList.add('hidden')
                roundTrip.classList.add('hidden')

                pickUp.classList.add('hidden')
                dropDown.classList.add('hidden')
                
                airportService.classList.add('hidden')
                outstationService.classList.add('hidden')

                rentalParent.classList.remove('hidden')
                dropParent.classList.add('hidden')

            }

            document.querySelector("#bookingForm [name='service']").value = value

        }
        
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelector("#bookingForm [name='outstationService']").value = '0'
            document.querySelector("#bookingForm [name='airportService']").value = '0'
            sessionStorage.removeItem('bookingInfo');
            pickUp.classList.add('active')
            oneWayTrip.classList.add('active')
        });

        document.addEventListener("DOMContentLoaded", () => {
            toggleTrip('0')
            toggleService('0')
        });

        function formValidation(event) {
            console.log("formValidation")
            const validateIndianPhoneNumber = (phoneNumber) => {
                const regex = /^(?:\+91)?[0-9]{10}$/;
                return regex.test(phoneNumber);
            }

            const mobile = !isNaN(Number(document.querySelector("#bookingForm [name='mobile']").value)) ? Number(document.querySelector("#bookingForm [name='mobile']").value) : 0
            const name = String(document.querySelector("#bookingForm [name='name']").value)
            const service = String(document.querySelector("#bookingForm [name='service']").value)
            const airportService = service=='1' ? String(document.querySelector("#bookingForm [name='airportService']").value) : null
            const outstationService = service == '0' ? String(document.querySelector("#bookingForm [name='outstationService']").value) : null
            const dropLocation =  service !== '2' ? String(document.querySelector("#bookingForm [name='dropLocation']").value) : ""
            const pickupLocation = String(document.querySelector("#bookingForm [name='pickupLocation']").value)
            const serviceType = service !== '2' ? service == '0' && outstationService =='1' ? 'Round Trip' : 'One-Way Trip' : 'Rental'
            const rentalpackage = service == '2' ? String(document.querySelector("#bookingForm [name='rentalpackage']").value) : null
            
            document.querySelector("#bookingForm [name='mobile']").value = mobile
            
            if (name.trim() == '') {
                alert("Enter a Name")
                return false
            }else if (!validateIndianPhoneNumber(mobile)) {
                alert("Enter Valid Mobile Number")
                return false
            } else {
                
                document.querySelector("#bookingForm [name='serviceType']").value = serviceType
                const bookingInfo = {
                    service,
                    airportService,
                    outstationService,
                    name,
                    mobile,
                    dropLocation,
                    pickupLocation,
                    serviceType,
                    rentalpackage,
                };
                console.log("booking form",bookingInfo)
                sessionStorage.setItem("bookingInfo", JSON.stringify(bookingInfo));
                return true
            }
        }

    </script>
</span>
